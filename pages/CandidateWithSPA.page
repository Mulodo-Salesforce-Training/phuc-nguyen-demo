<apex:page showHeader="false" sidebar="false" standardStylesheets="false" applyHtmlTag="false" applyBodyTag="false" docType="html-5.0" controller="SPA_CandidateController">
	<html>
		<head>
	    	<!-- Link to angular lib -->
	    	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	        <meta charset="UTF-8" />
	        <meta http-equiv="x-ua-compatible" content="ie=edge" />
	        <title>SPA Candidate</title>
	        <!-- Import the Design System style sheet -->
	        <apex:slds />
	        <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular.min.js" />
	        <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular-route.js" />
	    	<style>
				* {
					font-size   : 14px;
				}

				body {
					margin      : 0px auto;
					max-width   : 1000px;
					padding     : 0px;
				}

				#logo img {
					max-width : 150px;
					height    : auto;
				}

				#brand {
					margin      : auto auto;
					color       : red;
					font-size   : 35px;
					font-style  : italic;
				}

				#header {
					max-height : 150xp;
				}

				#info span {
					font-weight : bold;
					padding     : 5px;
					border      : 1px solid black;
					display     : inline-block;
					margin      : 5px auto;
				}

				#control_button #create_new_button, #list_button {
					width       : 140px;
					height      : 40px;
					font-weight : bold;
					font-size   : 14px;
					border      : 1px solid;
				}

				#create_new_button, #list_button : hover {
					background-color : green;
				}

				#weather_info {
					max-width : 60%;
					margin    : auto;
					color     : red;
				}

				#weather_info h2 {
					color       : blue;
					font-weight : bold;
					font-style  : italic;
				}

				#weather_info span {
					font-size : 20px; !important
				}

				#table {
					margin-top : 15px;
				}

				#table label {
					margin       : 10px auto;
					font-size    : 30px;
					padding-left : 15px;
					color        : #56BCFF;
				}

				/* Paste this css to your style sheet file or under head tag */
				/* This only works with JavaScript,
				if it's not present, don't show loader */
				.no-js #loader { display: none;  }
				.js #loader { display: block; position: absolute; left: 100px; top: 0; }
				.se-pre-con {
				    position   : fixed;
				    left       : 0px;
				    top        : 0px;
				    width      : 100%;
				    height     : 100%;
				    z-index    : 9999;
				    background : rgba(48, 52, 61, 0.8);
				}

				.se-pre-con img {
					position   : fixed;
				    left       : calc( 50% - 30px );
				    top        : calc( 50% - 30px );
				    width      : 30px;
				    height     : 30px;
				    z-index    : 9999;
				}

	    	</style>
	    </head>
	    <body>
	    	<!-- Show icon waiting for loading -->
	    	<div class="se-pre-con">
	    		<img src="http://www.wallies.com/filebin/images/loading_apple.gif" alt="" />
	    	</div>
    	    <!-- REQUIRED SLDS WRAPPER -->
			<div class="slds-scope">
				<input type="hidden" value="{!ip}" id="ip_address" />
				<div class="slds-grid slds-wrap slds-grid_pull-padded" id="header">
					<div id="logo" class="slds-p-horizontal_small slds-size_1-of-1 slds-medium-size_2-of-6">
						<img src="{!URLFOR($Resource.Mulodo, 'mulodo.jpg')}" alt="logo" />
					</div>
					<div class="slds-text-heading_large slds-text-align_center slds-p-horizontal_small slds-size_1-of-1 slds-medium-size_4-of-6" id="brand">
						CANDIDATE CONTROL
					</div>
				</div>
				<div id="content" ng-app="candidateSPA" ng-controller="candidateController" ng-init="init();">
					<div id="info" class="slds-text-align_center">
						<span>Tổng số record: {{total}}</span>
						<span>Date/Time: {{date | date:'hh:mm:ss dd/MM/yyyy'}}</span>
						<span>Tên công ty: Mulodo VN</span>
						<span>Tên nhân viên: {!$User.FirstName + ' ' + $User.LastName}</span>
					</div>
					<div id="weather_info">
						<h2>Weather Info:</h2>
						<marquee behavior="" direction=""><span>Location: {{location}} || Lon: {{lon}} - Lat: {{lat}} || Nhiệt độ: {{temp / 10}}</span></marquee>
					</div>
					<div id="control_button">
						<button id="list_button" class="slds-button slds-button_neutral"><a href="#!">Danh sách</a></button>
						<button id="create_new_button" class="slds-button slds-button_neutral"><a href="#!/candidate/123">Tạo mới</a></button>
					</div>
					<div class="ng-view"></div>
				</div>
			</div>
			<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
			<script type="text/javascript">
				$jQuery = jQuery.noConflict();
				$jQuery(window).on( 'load', function () {
					$jQuery(".se-pre-con").fadeOut('slow');
			        $jQuery(".se-pre-con img").fadeOut('slow');
			    });
				let client_ip = document.getElementById('ip_address').value;
				let app       = angular.module( 'candidateSPA', ["ngRoute"] );
				app.config( function( $routeProvider ) {
				    $routeProvider
				    .when("/candidate/:id", {
				    	templateUrl : "{!URLFOR($Resource.Page, 'detail.html')}",
				        controller  : "candidateList"
				    })
				    .when("/", {
				        templateUrl : "{!URLFOR($Resource.Page, 'list.html')}",
				        controller : "candidateList"
				    })
				});
				app.controller( 'candidateList', function( $scope ) {
					$scope.init = function () {
						Visualforce.remoting.Manager.invokeAction (
				            '{!$RemoteAction.SPA_CandidateController.getList}',
				            function ( result, event ) {
				            	$scope.$apply( function() {
					            	$scope.data = result;
				            	});
				            },
				            { escape : false }
				        );
					}
				});
				app.controller( 'candidateController', function( $scope, $interval, $http ) {
					let tick = function() {
	            		$scope.date = Date.now();
					};

					let weather = function () {
						Visualforce.remoting.Manager.invokeAction (
				            '{!$RemoteAction.SPA_CandidateController.getWeather}',
				            client_ip
				            ,
				            function ( result, event ) {
				            	let resultJson      = JSON.parse( result );
				            	$scope.$apply( function() {
					            	$scope.location = resultJson.name;
					            	$scope.lon      = resultJson.coord.lon;
					            	$scope.lat      = resultJson.coord.lat;
					            	$scope.temp     = resultJson.main.temp;
				            	});
				            },
				            { escape : false }
				        );
					};

					$scope.init = function () {
						weather();
						// Clock
						tick();
						$interval( tick, 1000 );
						// End clock
						Visualforce.remoting.Manager.invokeAction (
				            '{!$RemoteAction.SPA_CandidateController.getCount}',
				            function ( result, event ) {
				            	$scope.total = 0;
				            	if ( event.status ) {
					            	$scope.$apply( function() {
					            		$scope.total = result;
					            	});
				            	}
				            },
				            { escape : false }
				        );
					};
				});
			</script>
	    </body>
    </html>
</apex:page>