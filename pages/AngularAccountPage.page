<apex:page showHeader="false" sidebar="false" standardStylesheets="false" applyHtmlTag="true" applyBodyTag="false" docType="html-5.0"  controller="CustomAccountController">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" lang="en">
        <head>
            <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js" />
            <apex:outputLink rel="stylesheet" value="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
            <meta charset="utf-8" />
	        <meta http-equiv="x-ua-compatible" content="ie=edge" />
	        <title>Angular Accounts List</title>
	        <meta name="viewport" content="width=device-width, initial-scale=1" />
	        <!-- Import the Design System style sheet -->
	        <apex:slds />
        </head>
        <body>
        	<!-- REQUIRED SLDS WRAPPER -->
        	<div class="slds-scope">
	            <div ng-app="MyApp">
	                <div ng-controller="myController">
	                    <label>Search: <input ng-model="mcm.searchText" ng-keyup="getFilteredData($event)" class="slds-input" placeholder="Text to filter result" /></label>
	                    <table class="table">
	                        <thead>
	                            <tr>
	                                <th>Account Name</th>
	                                <th>Account Number</th>
	                            </tr>
	                        </thead>
	                        <tbody>
	                            <tr ng-repeat="accVar in AccountData">
	                                <td>{{accVar.Name}}</td>
	                                <td>{{accVar.AccountNumber}}</td>
	                            </tr>
	                        </tbody>
	                    </table>
	                </div>
	            </div>
	        </div>
            <script type="text/javascript">
                var app = angular.module('MyApp',[]);
                app.factory('VFRemotingFactory',function($q,$rootScope){
                    var factory = {};
                    factory.getData = function(searchText){
                        var deferred = $q.defer();
                        GetAllAccountsByFilter(function(result){
                            $rootScope.$apply(function(){
                                deferred.resolve(result);
                            });
                        }, searchText);
                        return deferred.promise;
                    }
                    return factory;
                });
                function GetAllAccountsByFilter(callback, searchText){
                    if(searchText == undefined)
                    {
                        searchText = '';
                    }
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.CustomAccountController.GetAllAccountsByFilter}', searchText,
                        callback,
                        {escape: false}
                    );
                }
                app.controller('myController',function($scope,VFRemotingFactory){
                    $scope.mcm = {};
                    $scope.getFilteredData = function($event){
                        if($scope.mcm.searchText.length > 1)
                        {
                            var searchTxt = $scope.mcm.searchText;
                            VFRemotingFactory.getData(searchTxt).then(function(result){
                                $scope.AccountData = result;
                            });
                        }
                        else
                        {
                            var searchTxt = $scope.mcm.searchText;
                            VFRemotingFactory.getData().then(function(result){
                                $scope.AccountData = result;
                            });
                        }
                    };
                                  $scope.Prafull = {};
                    VFRemotingFactory.getData().then(function(result){
                        $scope.AccountData = result;
                    });
                });
            </script>
        </body>
    </html>
</apex:page>